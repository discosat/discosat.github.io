<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flight planning (csp_proc) &mdash; Discosat 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Documentation" href="../sub-docs/csp_proc/index.html" />
    <link rel="prev" title="Cortex-M7 (low-power core)" href="cortex-m7.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Discosat
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Disco 2</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../terms-and-abbreviations.html">Terms and Abbreviations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Software</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="system-setup.html">System setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="image-processing-pipeline.html">Image Processing Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="camera-controller.html">Camera Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="app-sys-manager.html">Application/System manager (Linux system calls over CSP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="cortex-m7.html">Cortex-M7 (low-power core)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Flight planning (<cite>csp_proc</cite>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../sub-docs/csp_proc/index.html">Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sub-docs/csp_proc_function_reference.html"><cite>csp_proc</cite> Function Reference</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Discosat</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Disco 2</a></li>
          <li class="breadcrumb-item"><a href="index.html">Software</a></li>
      <li class="breadcrumb-item active">Flight planning (<cite>csp_proc</cite>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/disco-2/software/flight-planning-csp-proc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flight-planning-csp-proc">
<h1>Flight planning (<cite>csp_proc</cite>)<a class="headerlink" href="#flight-planning-csp-proc" title="Link to this heading">ÔÉÅ</a></h1>
<p><cite>csp_proc</cite> is the library responsible for low-level flight planning / orchestration of the CSP nodes for scientific observations. It provides a set of general instructions that can be used to set libparam parameters with simple synchronization and conditional logic. The library is described in more detail on its own documentation page at <a class="reference external" href="https://discosat.github.io/csp_proc/">https://discosat.github.io/csp_proc/</a> - which is also embedded as the following sub-pages.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sub-docs/csp_proc/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sub-docs/csp_proc_function_reference.html"><cite>csp_proc</cite> Function Reference</a></li>
</ul>
</div>
<p>In the context of DISCO-II, <cite>csp_proc</cite> lives on the Cortex-M7 node, and the parameters it exposes can be seen on the <a class="reference external" href="cortex-m7.html">Cortex-M7</a> page.</p>
<p>A simple observation sequence based on time might simply look like the following. Nodes are abbreviated so <code class="docutils literal notranslate"><span class="pre">$M7</span></code> is the Cortex-M7 node, <code class="docutils literal notranslate"><span class="pre">$A53</span></code> is the Cortex-A53 node, <code class="docutils literal notranslate"><span class="pre">$CAM</span></code> is the camera control node and <code class="docutils literal notranslate"><span class="pre">$DIPP</span></code> is the image processing node.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>proc new

# [START] Observation procedure
proc set p_uint32[0] 1744407764 $M7  # This is the GNSS time we want to start the observation
proc block gnss_time &gt;= p_uint32[0] $M7
proc set wake_a53 1 $M7

proc set p_uint8[0] 1 $M7  # Use GPR for following comparison
proc block a53_status == p_uint8[0] $M7
proc set mng_camera_control $CAM $A53  # Start camera control node
proc set mng_dipp $DIPP $A53  # Start image processing node

proc unop gnss_time idt p_uint32[1] $M7  # Log the time of the observation

proc set capture_param &quot;CAMERA_TYPE=VMB;CAMERA_ID=1800 U-2040c;NUM_IMAGES=1;EXPOSURE=55000;ISO=0;&quot; $CAM  # Take a single image
proc set pipeline_run 1 $DIPP  # Run image processing pipeline
proc set p_uint8[1] 0 $M7  # Use GPR for following comparison
proc block pipeline_run == 0 $DIPP  # Wait for image processing to finish

# Optionally kill camera control and dipp processes
proc set mng_camera_control 0 $A53  # Stop camera control node
proc set mng_dipp 0 $A53  # Stop image processing node

proc set suspend_a53 1 $A53  # Suspend A53 node
# [END] Observation procedure

proc push 42 $M7
proc run 42 $M7
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cortex-m7.html" class="btn btn-neutral float-left" title="Cortex-M7 (low-power core)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../sub-docs/csp_proc/index.html" class="btn btn-neutral float-right" title="Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Discosat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>